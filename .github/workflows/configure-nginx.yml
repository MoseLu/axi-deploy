name: Configure Nginx

description: "é…ç½®Nginxï¼ŒåŒ…å«é…ç½®ç”Ÿæˆå’ŒéªŒè¯"

on:
  workflow_call:
    inputs:
      project:
        required: true
        type: string
        description: "é¡¹ç›®åç§°"
      nginx_config:
        required: false
        type: string
        description: "Nginxé…ç½®"
        default: ""
      server_host:
        required: true
        type: string
        description: "æœåŠ¡å™¨åœ°å€"
      server_user:
        required: true
        type: string
        description: "æœåŠ¡å™¨ç”¨æˆ·"
      server_key:
        required: true
        type: string
        description: "æœåŠ¡å™¨å¯†é’¥"
      server_port:
        required: true
        type: string
        description: "æœåŠ¡å™¨ç«¯å£"
      domain:
        required: false
        type: string
        description: "åŸŸå"
        default: "redamancy.com.cn"
      nginx_conf_dir:
        required: false
        type: string
        description: "Nginxé…ç½®ç›®å½•"
        default: "/www/server/nginx/conf/conf.d/redamancy"
      apps_root:
        required: false
        type: string
        description: "åº”ç”¨ç›®å½•è·¯å¾„"
        default: "/srv/apps"
      static_root:
        required: false
        type: string
        description: "é™æ€æ–‡ä»¶ç›®å½•è·¯å¾„"
        default: "/srv/static"
      backend_port:
        required: false
        type: string
        description: "åŽç«¯æœåŠ¡ç«¯å£"
        default: "8080"
      service_name:
        required: false
        type: string
        description: "æœåŠ¡åç§°"
        default: "star-cloud"
    outputs:
      config_success:
        description: "é…ç½®æ˜¯å¦æˆåŠŸ"
        value: ${{ jobs.configure.outputs.config_success }}

jobs:
  configure:
    runs-on: ubuntu-latest
    outputs:
      config_success: ${{ steps.set-outputs.outputs.config_success }}
    
    steps:
      - name: éªŒè¯è¾“å…¥å‚æ•°
        run: |
          echo "ðŸ” éªŒè¯è¾“å…¥å‚æ•°..."
          echo "- é¡¹ç›®: ${{ inputs.project }}"
          echo "- æœåŠ¡å™¨: ${{ inputs.server_host }}:${{ inputs.server_port }}"
          echo "- ç”¨æˆ·: ${{ inputs.server_user }}"
          
          if [ -z "${{ inputs.nginx_config }}" ]; then
            echo "âš ï¸ æ²¡æœ‰æä¾›Nginxé…ç½®ï¼Œè·³è¿‡é…ç½®æ­¥éª¤"
            echo "config_success=true" >> $GITHUB_OUTPUT
            exit 0
          fi
          
          echo "âœ… è¾“å…¥å‚æ•°éªŒè¯é€šè¿‡"

      - name: é…ç½®Nginx
        if: inputs.nginx_config != ''
        uses: appleboy/ssh-action@v1.0.3
        with:
          host: ${{ inputs.server_host }}
          username: ${{ inputs.server_user }}
          key: ${{ inputs.server_key }}
          port: ${{ inputs.server_port }}
          script: |
            echo "ðŸ”§ é…ç½®Nginx..."
            
            NGINX_CONF_DIR="${{ inputs.nginx_conf_dir || '/www/server/nginx/conf/conf.d/redamancy' }}"
            PROJECT="${{ inputs.project }}"
            
            # ç”Ÿæˆé¡¹ç›®è·¯ç”±é…ç½®
            ROUTE_CONF="$NGINX_CONF_DIR/route-$PROJECT.conf"
            
            # ä¿æŠ¤ä¸»é…ç½®æ–‡ä»¶ - ç¡®ä¿ä¸ä¼šè¢«ä¿®æ”¹
            MAIN_CONF="$NGINX_CONF_DIR/00-main.conf"
            echo "ðŸ›¡ï¸ ä¿æŠ¤ä¸»é…ç½®æ–‡ä»¶: $MAIN_CONF"
            if [ -f "$MAIN_CONF" ]; then
              echo "âœ… ä¸»é…ç½®æ–‡ä»¶å­˜åœ¨ï¼Œè®¾ç½®åªè¯»æƒé™ä¿æŠ¤"
              sudo chmod 444 "$MAIN_CONF"
              echo "ðŸ“‹ ä¸»é…ç½®æ–‡ä»¶æƒé™: $(ls -la $MAIN_CONF)"
            else
              echo "âš ï¸ ä¸»é…ç½®æ–‡ä»¶ä¸å­˜åœ¨: $MAIN_CONF"
            fi
            
            # åˆ›å»ºé¡¹ç›®ä¸“ç”¨å¤‡ä»½ç›®å½•
            BACKUP_DIR="$NGINX_CONF_DIR/backups"
            PROJECT_BACKUP_DIR="$BACKUP_DIR/$PROJECT"
            echo "ðŸ“ åˆ›å»ºé¡¹ç›®å¤‡ä»½ç›®å½•: $PROJECT_BACKUP_DIR"
            sudo mkdir -p "$PROJECT_BACKUP_DIR"
            sudo chmod 755 "$PROJECT_BACKUP_DIR"
            
            # å¤‡ä»½æ—§çš„è·¯ç”±é…ç½®æ–‡ä»¶
            if [ -f "$ROUTE_CONF" ]; then
              echo "ðŸ“‹ å¤‡ä»½æ—§è·¯ç”±é…ç½®æ–‡ä»¶: $ROUTE_CONF"
              BACKUP_FILE="$PROJECT_BACKUP_DIR/route-$PROJECT.conf.backup.$(date +%Y%m%d_%H%M%S)"
              sudo cp "$ROUTE_CONF" "$BACKUP_FILE"
              sudo rm -f "$ROUTE_CONF"
              echo "âœ… æ—§è·¯ç”±é…ç½®æ–‡ä»¶å·²å¤‡ä»½åˆ°: $BACKUP_FILE"
              
              # æ¸…ç†æ—§çš„å¤‡ä»½æ–‡ä»¶ï¼Œåªä¿ç•™æœ€è¿‘2ä¸ª
              echo "ðŸ§¹ æ¸…ç†æ—§çš„å¤‡ä»½æ–‡ä»¶..."
              BACKUP_FILES=$(ls -t "$PROJECT_BACKUP_DIR"/route-$PROJECT.conf.backup.* 2>/dev/null | tail -n +3)
              if [ -n "$BACKUP_FILES" ]; then
                echo "ðŸ—‘ï¸ åˆ é™¤æ—§çš„å¤‡ä»½æ–‡ä»¶:"
                echo "$BACKUP_FILES" | xargs -r sudo rm -f
                echo "âœ… æ—§å¤‡ä»½æ–‡ä»¶å·²æ¸…ç†ï¼Œä¿ç•™æœ€è¿‘2ä¸ªå¤‡ä»½"
              else
                echo "ðŸ“‹ æ²¡æœ‰éœ€è¦æ¸…ç†çš„æ—§å¤‡ä»½æ–‡ä»¶"
              fi
            else
              echo "ðŸ“‹ æ²¡æœ‰æ‰¾åˆ°æ—§çš„è·¯ç”±é…ç½®æ–‡ä»¶: $ROUTE_CONF"
            fi
            
            # ä¸å†åˆ é™¤å…¶ä»–é¡¹ç›®çš„é…ç½®æ–‡ä»¶ï¼Œæ¯ä¸ªé¡¹ç›®éƒ½åº”è¯¥æœ‰è‡ªå·±çš„é…ç½®æ–‡ä»¶
            echo "ðŸ“‹ ä¿æŒå…¶ä»–é¡¹ç›®çš„é…ç½®æ–‡ä»¶ä¸å˜..."
            echo "ðŸ“ å½“å‰å­˜åœ¨çš„routeé…ç½®æ–‡ä»¶:"
            ls -la $NGINX_CONF_DIR/route-*.conf 2>/dev/null || echo "æ²¡æœ‰æ‰¾åˆ°routeé…ç½®æ–‡ä»¶"
            
            # æ£€æŸ¥nginx_configæ˜¯å¦åŒ…å«serverå—
            if echo '${{ inputs.nginx_config }}' | grep -q '^server {'; then
              # å¦‚æžœåŒ…å«serverå—ï¼Œæå–locationå—
              echo "ðŸ“ æ£€æµ‹åˆ°serverå—é…ç½®ï¼Œæå–locationå—..."
              LOCATION_CONFIG=$(echo '${{ inputs.nginx_config }}' | sed -n '/location /,/}/p' | sed 's/^/    /')
              
              # æ¸…ç†å’Œæ ¼å¼åŒ–locationé…ç½®
              CLEANED_CONFIG=$(echo "$LOCATION_CONFIG" | sed 's/\\\\.html$/\\.html$/g' | sed 's/\\"/"/g')
              
              # ç›´æŽ¥å†™å…¥é…ç½®
              echo "$CLEANED_CONFIG" | sudo tee $ROUTE_CONF
              echo "âœ… Nginxé…ç½®å·²å†™å…¥: $ROUTE_CONF (æå–çš„locationå—)"
            else
              # å¦‚æžœä¸åŒ…å«serverå—ï¼Œç›´æŽ¥ä½¿ç”¨locationå—
              echo "ðŸ“ æ£€æµ‹åˆ°locationå—é…ç½®ï¼Œç›´æŽ¥å†™å…¥..."
              
              # æ¸…ç†å’Œæ ¼å¼åŒ–nginx_configï¼Œç¡®ä¿æ­£ç¡®çš„ç¼©è¿›
              CLEANED_CONFIG=$(echo '${{ inputs.nginx_config }}' | sed 's/\\\\.html$/\\.html$/g' | sed 's/\\"/"/g' | sed 's/^/    /')
              
              # æ£€æµ‹å¹¶ä¿®å¤åµŒå¥—locationå—é—®é¢˜
              echo "ðŸ” æ£€æµ‹åµŒå¥—locationå—..."
              # ä¿®å¤æ£€æµ‹é€»è¾‘ï¼šåªæœ‰å½“çœŸæ­£æœ‰åµŒå¥—locationæ—¶æ‰å¤„ç†
              LOCATION_COUNT=$(echo "$CLEANED_CONFIG" | grep -c "location.*{")
              if [ "$LOCATION_COUNT" -gt 1 ]; then
                echo "âš ï¸ æ£€æµ‹åˆ°å¤šä¸ªlocationå—ï¼Œæ£€æŸ¥æ˜¯å¦æœ‰åµŒå¥—..."
                # æ£€æŸ¥æ˜¯å¦æœ‰çœŸæ­£çš„åµŒå¥—ï¼ˆä¸€ä¸ªlocationå—å†…åŒ…å«å¦ä¸€ä¸ªlocationå—ï¼‰
                NESTED_COUNT=$(echo "$CLEANED_CONFIG" | awk '/location /{count++} /}/{if(count>0) count--} END{print count}')
                if [ "$NESTED_COUNT" -gt 0 ]; then
                  echo "âš ï¸ æ£€æµ‹åˆ°çœŸæ­£çš„åµŒå¥—locationå—ï¼Œæ­£åœ¨ä¿®å¤..."
                  echo "âœ… åµŒå¥—locationå—å·²ä¿®å¤ï¼Œä½¿ç”¨ç®€åŒ–é…ç½®"
                  
                  # æ ¹æ®é¡¹ç›®ç±»åž‹ç”Ÿæˆæ­£ç¡®çš„é…ç½®
                  if echo "$CLEANED_CONFIG" | grep -q "${{ inputs.static_root || '/srv/static' }}/${{ inputs.project }}/"; then
                    echo "âœ… æ£€æµ‹åˆ°é™æ€é¡¹ç›®ï¼Œç”Ÿæˆç®€åŒ–é…ç½®..."
                    CLEANED_CONFIG=$(echo -e "    location /docs/ {\n        alias ${{ inputs.static_root || '/srv/static' }}/${{ inputs.project }}/;\n        index index.html;\n        try_files \$uri \$uri/ /docs/index.html;\n        \n        # ç¡®ä¿ä¸ç¼“å­˜HTMLæ–‡ä»¶\n        add_header Cache-Control \"no-cache, no-store, must-revalidate\" always;\n        add_header Pragma \"no-cache\" always;\n        add_header Expires \"0\" always;\n    }\n    \n    # å¤„ç† /docs è·¯å¾„ï¼ˆä¸å¸¦æ–œæ ï¼‰- é‡å®šå‘åˆ° /docs/\n    location = /docs {\n        return 301 /docs/;\n    }")
                    echo "ðŸ“‹ ç”Ÿæˆçš„é…ç½®:"
                    echo "$CLEANED_CONFIG"
                  elif echo "$CLEANED_CONFIG" | grep -q "${{ inputs.apps_root || '/srv/apps' }}/${{ inputs.project }}/"; then
                    echo "âœ… æ£€æµ‹åˆ°åŽç«¯é¡¹ç›®ï¼Œç”Ÿæˆç®€åŒ–é…ç½®..."
                    CLEANED_CONFIG=$(echo -e "    # é™æ€æ–‡ä»¶æœåŠ¡\n    location /static/ {\n        alias ${{ inputs.apps_root || '/srv/apps' }}/${{ inputs.project }}/front/;\n        expires 1y;\n        add_header Cache-Control \"public, immutable\";\n    }\n    \n    # APIä»£ç†\n    location /api/ {\n        proxy_pass http://127.0.0.1:${{ inputs.backend_port || '8080' }}/;\n        proxy_set_header Host \$host;\n        proxy_set_header X-Real-IP \$remote_addr;\n        proxy_set_header X-Forwarded-For \$proxy_add_x_forwarded_for;\n        proxy_set_header X-Forwarded-Proto \$scheme;\n        client_max_body_size 100M;\n    }\n    \n    # å¥åº·æ£€æŸ¥\n    location /health {\n        proxy_pass http://127.0.0.1:${{ inputs.backend_port || '8080' }}/health;\n        proxy_set_header Host \$host;\n    }\n    \n    # ä¸Šä¼ æ–‡ä»¶\n    location /uploads/ {\n        alias ${{ inputs.apps_root || '/srv/apps' }}/${{ inputs.project }}/uploads/;\n        try_files \$uri =404;\n    }\n    \n    # é»˜è®¤è·¯ç”±\n    location / {\n        root ${{ inputs.apps_root || '/srv/apps' }}/${{ inputs.project }}/front;\n        try_files \$uri \$uri/ /index.html;\n        \n        # é™æ€èµ„æºç¼“å­˜\n        location ~* \\.(js|css|png|jpg|jpeg|gif|ico|svg|woff|woff2|ttf|eot)$ {\n            expires 1y;\n            add_header Cache-Control \"public, immutable\";\n        }\n    }")
                    echo "ðŸ“‹ ç”Ÿæˆçš„é…ç½®:"
                    echo "$CLEANED_CONFIG"
                  else
                    echo "âš ï¸ æœªçŸ¥é¡¹ç›®ç±»åž‹ï¼Œä½¿ç”¨åŽŸå§‹é…ç½®"
                  fi
                else
                  echo "âœ… æ²¡æœ‰æ£€æµ‹åˆ°çœŸæ­£çš„åµŒå¥—locationå—ï¼Œä¿æŒåŽŸå§‹é…ç½®"
                fi
              else
                echo "âœ… æ²¡æœ‰æ£€æµ‹åˆ°åµŒå¥—locationå—"
              fi
              
              # æ£€æŸ¥é…ç½®æ˜¯å¦åŒ…å«æ­£ç¡®çš„è·¯å¾„
              if echo "$CLEANED_CONFIG" | grep -q "${{ inputs.static_root || '/srv/static' }}/${{ inputs.project }}/"; then
                echo "âœ… æ£€æµ‹åˆ°æ­£ç¡®çš„éƒ¨ç½²è·¯å¾„ (${{ inputs.static_root || '/srv/static' }}/${{ inputs.project }}/)"
              elif echo "$CLEANED_CONFIG" | grep -q "/www/wwwroot/${{ inputs.domain || 'redamancy.com.cn' }}/docs/"; then
                echo "âœ… æ£€æµ‹åˆ°æ­£ç¡®çš„éƒ¨ç½²è·¯å¾„ (/www/wwwroot/${{ inputs.domain || 'redamancy.com.cn' }}/docs/)"
              elif echo "$CLEANED_CONFIG" | grep -q "${{ inputs.apps_root || '/srv/apps' }}/${{ inputs.project }}/"; then
                echo "âœ… æ£€æµ‹åˆ°æ­£ç¡®çš„éƒ¨ç½²è·¯å¾„ (${{ inputs.apps_root || '/srv/apps' }}/${{ inputs.project }}/)"
              else
                echo "âš ï¸ è­¦å‘Š: é…ç½®ä¸­å¯èƒ½ä½¿ç”¨äº†é”™è¯¯çš„è·¯å¾„"
                echo "å½“å‰é…ç½®: $CLEANED_CONFIG"
              fi
              
              # æ£€æŸ¥æ˜¯å¦æœ‰é‡å¤çš„locationå®šä¹‰
              echo "ðŸ” æ£€æŸ¥locationå†²çª..."
              
              # æ£€æŸ¥å½“å‰é…ç½®ä¸­æ˜¯å¦åŒ…å«location /
              CURRENT_HAS_LOCATION_ROOT=false
              if echo "$CLEANED_CONFIG" | grep -q "location /[^a-zA-Z]"; then
                CURRENT_HAS_LOCATION_ROOT=true
                echo "ðŸ“‹ å½“å‰é…ç½®åŒ…å« location / (æ ¹è·¯å¾„)"
              fi
              
              # æ£€æŸ¥çŽ°æœ‰é…ç½®ä¸­æ˜¯å¦åŒ…å«location /
              EXISTING_HAS_LOCATION_ROOT=false
              if [ -f "$ROUTE_CONF" ] && grep -q "location /[^a-zA-Z]" "$ROUTE_CONF"; then
                EXISTING_HAS_LOCATION_ROOT=true
                echo "ðŸ“‹ çŽ°æœ‰é…ç½®åŒ…å« location / (æ ¹è·¯å¾„)"
              fi
              
              # æ£€æŸ¥å…¶ä»–routeæ–‡ä»¶ä¸­æ˜¯å¦åŒ…å«location /
              OTHER_HAS_LOCATION_ROOT=false
              for other_conf in $NGINX_CONF_DIR/route-*.conf; do
                if [ -f "$other_conf" ] && [ "$other_conf" != "$ROUTE_CONF" ] && grep -q "location /[^a-zA-Z]" "$other_conf"; then
                  OTHER_HAS_LOCATION_ROOT=true
                  echo "ðŸ“‹ å…¶ä»–é…ç½®æ–‡ä»¶ $other_conf åŒ…å« location / (æ ¹è·¯å¾„)"
                  break
                fi
              done
              
              # åªæœ‰å½“çœŸæ­£å­˜åœ¨æ ¹è·¯å¾„å†²çªæ—¶æ‰å¤„ç†
              if [ "$CURRENT_HAS_LOCATION_ROOT" = true ] && [ "$OTHER_HAS_LOCATION_ROOT" = true ]; then
                echo "âš ï¸ æ£€æµ‹åˆ°å¤šä¸ªé…ç½®æ–‡ä»¶éƒ½æœ‰ location / (æ ¹è·¯å¾„)ï¼Œéœ€è¦åè°ƒé…ç½®"
                echo "ðŸ“‹ å½“å‰é¡¹ç›®: $PROJECT"
                echo "ðŸ“‹ å½“å‰é…ç½®: $CLEANED_CONFIG"
                
                # å¯¹äºŽé™æ€é¡¹ç›®ï¼Œä¸åº”è¯¥æœ‰location /é…ç½®
                if echo "$CLEANED_CONFIG" | grep -q "${{ inputs.static_root || '/srv/static' }}/${{ inputs.project }}/"; then
                  echo "âš ï¸ é™æ€é¡¹ç›®ä¸åº”è¯¥é…ç½®location /ï¼Œè·³è¿‡æ ¹è·¯å¾„é…ç½®"
                  # ç§»é™¤location /é…ç½®ï¼Œåªä¿ç•™é¡¹ç›®ç›¸å…³é…ç½®
                  CLEANED_CONFIG=$(echo "$CLEANED_CONFIG" | grep -v "location /[^a-zA-Z]")
                  echo "âœ… å·²ç§»é™¤å†²çªçš„location /é…ç½®"
                elif echo "$CLEANED_CONFIG" | grep -q "${{ inputs.apps_root || '/srv/apps' }}/${{ inputs.project }}/"; then
                  echo "âœ… åŽç«¯é¡¹ç›®å¯ä»¥é…ç½®location /ï¼Œè¿™æ˜¯ä¸»é¡¹ç›®"
                else
                  echo "âš ï¸ æœªçŸ¥é¡¹ç›®ç±»åž‹ï¼Œè·³è¿‡location /é…ç½®ä»¥é¿å…å†²çª"
                  CLEANED_CONFIG=$(echo "$CLEANED_CONFIG" | grep -v "location /[^a-zA-Z]")
                fi
              else
                echo "âœ… æ²¡æœ‰location /å†²çªï¼Œå†™å…¥å®Œæ•´é…ç½®"
              fi
              
              echo "âœ… å†™å…¥æ–°é…ç½®"
              echo "$CLEANED_CONFIG" | sudo tee $ROUTE_CONF
              
              echo "âœ… Nginxé…ç½®å·²å†™å…¥: $ROUTE_CONF (locationå—)"
            fi
            
            # æ£€æŸ¥Nginxé…ç½®è¯­æ³•
            if sudo nginx -t; then
              echo "âœ… Nginxé…ç½®è¯­æ³•æ£€æŸ¥é€šè¿‡"
            else
              echo "âŒ Nginxé…ç½®è¯­æ³•é”™è¯¯"
              echo "ðŸ“‹ ç”Ÿæˆçš„é…ç½®æ–‡ä»¶å†…å®¹:"
              cat $ROUTE_CONF
              echo "ðŸ“‹ Nginx é”™è¯¯æ—¥å¿—:"
              sudo tail -n 20 /var/log/nginx/error.log
              exit 1
            fi
            
            # æ£€æŸ¥ç”Ÿæˆçš„é…ç½®æ–‡ä»¶
            echo "ðŸ“‹ ç”Ÿæˆçš„ Nginx é…ç½®æ–‡ä»¶å†…å®¹:"
            cat $ROUTE_CONF
            
            # æ˜¾ç¤ºé…ç½®æ‘˜è¦
            echo "ðŸ“‹ é…ç½®æ‘˜è¦:"
            echo "- é¡¹ç›®: $PROJECT"
            echo "- é…ç½®æ–‡ä»¶: $ROUTE_CONF"
            echo "- é…ç½®ç±»åž‹: $(if echo '${{ inputs.nginx_config }}' | grep -q '^server {'; then echo 'serverå—æå–'; else echo 'locationå—ç›´æŽ¥'; fi)"
            echo "- æ˜¯å¦æ£€æµ‹åˆ°åµŒå¥—location: $(if echo "$CLEANED_CONFIG" | grep -A 5 -B 5 "location.*{" | grep -q "location.*{"; then echo 'æ˜¯'; else echo 'å¦'; fi)"
            echo "- é¡¹ç›®ç±»åž‹: $(if echo "$CLEANED_CONFIG" | grep -q "${{ inputs.static_root || '/srv/static' }}/${{ inputs.project }}/"; then echo 'é™æ€é¡¹ç›®'; elif echo "$CLEANED_CONFIG" | grep -q "${{ inputs.apps_root || '/srv/apps' }}/${{ inputs.project }}/"; then echo 'åŽç«¯é¡¹ç›®'; else echo 'æœªçŸ¥'; fi)"
            
            # é‡è½½Nginxé…ç½®
            if sudo systemctl reload nginx; then
              echo "âœ… Nginxé…ç½®é‡è½½å®Œæˆ"
            else
              echo "âŒ Nginxé‡è½½å¤±è´¥"
              echo "ðŸ“‹ Nginx é”™è¯¯æ—¥å¿—:"
              sudo tail -n 20 /var/log/nginx/error.log
              exit 1
            fi
            
            # æ¢å¤ä¸»é…ç½®æ–‡ä»¶æƒé™
            echo "ðŸ›¡ï¸ æ¢å¤ä¸»é…ç½®æ–‡ä»¶æƒé™..."
            if [ -f "$MAIN_CONF" ]; then
              sudo chmod 644 "$MAIN_CONF"
              echo "âœ… ä¸»é…ç½®æ–‡ä»¶æƒé™å·²æ¢å¤"
            fi
            
            echo "âœ… Nginxé…ç½®å®Œæˆ"
            echo "ðŸ“‹ å®žé™…åº”ç”¨çš„é…ç½®:"
            echo "location /docs/ { alias /srv/static/$PROJECT/; try_files \$uri \$uri/ /docs/index.html; }"
            echo "ðŸ“‹ å®Œæ•´é…ç½®å·²å†™å…¥: $ROUTE_CONF"

      - name: è®¾ç½®è¾“å‡º
        id: set-outputs
        run: |
          echo "config_success=true" >> $GITHUB_OUTPUT
          echo "âœ… è¾“å‡ºå·²è®¾ç½®"
          echo "- config_success: true"
